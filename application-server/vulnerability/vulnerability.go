package vulnerability

import (
	"encoding/json"
	"fmt"
	"io/ioutil"
	"os"

	"github.com/arora-aditya/monorepo/application-server/graph/model"
)

const VULNERABILITIES_FILE = "../vulnerability/query_github/frontend_data.json"

func GetAllVulnerabilities() []*model.Vulnerability {
	jsonFile, err := os.Open(VULNERABILITIES_FILE)
	if err != nil {
		fmt.Println(err)
	}

	byteValue, _ := ioutil.ReadAll(jsonFile)
	all_vulnerabilities := []*model.Vulnerability{}
	json.Unmarshal(byteValue, &all_vulnerabilities)

	return all_vulnerabilities
}
